% To Serve Man â€” LaTeX Preamble
% Beautiful cookbook typography

\documentclass[10pt,twoside,openright]{book}

% Page geometry - classical cookbook proportions
\usepackage[
    letterpaper,
    inner=1.5in,
    outer=1.25in,
    top=1in,
    bottom=1.25in,
    marginparwidth=0in,
    marginparsep=0in
]{geometry}

% Font configuration
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}

% Enhanced microtype configuration - CRITICAL for letterspacing
\usepackage[
    activate={true,nocompatibility},
    final,
    tracking=true,
    kerning=true,
    spacing=true,
    factor=1100,
    stretch=10,
    shrink=10
]{microtype}

% Use EB Garamond for body text
\usepackage{ebgaramond}

% Use Helvetica for sans-serif
\usepackage{helvet}

% Body text leading
\linespread{1.06}

% Prevent awkward page breaks in recipes
\usepackage{needspace}

% Section formatting
\usepackage{titlesec}

% Part formatting - centered, all caps, generous letterspacing
\titleformat{\part}[display]
    {\centering\Huge}
    {}
    {0pt}
    {\textls[150]{\MakeUppercase}}
\titlespacing*{\part}
    {0pt}
    {0.3\textheight}             % Push down from top
    {2\baselineskip}

% Chapter formatting - left-aligned, all caps with letterspacing
% Includes horizontal rule below
\titleformat{\chapter}[display]
    {\Large}
    {}
    {0pt}
    {\textls[150]{\MakeUppercase}}
    [\vspace{0.5em}\rule{\textwidth}{0.4pt}]
\titlespacing*{\chapter}
    {0pt}
    {3\baselineskip}             % Space before
    {1.5\baselineskip}           % Space after rule

% Recipe title - all caps with moderate letterspacing
% Preceded by horizontal rule
\titleformat{\section}
    {\LARGE\bfseries}
    {}
    {0pt}
    {\rule{\textwidth}{0.5pt}\vspace{0.75em}\par\noindent\textls[80]{\MakeUppercase}}
\titlespacing*{\section}
    {0pt}
    {2em}                        % Space before rule
    {0.5\baselineskip}           % Space after title

% Section labels: "Ingredients" and "Instructions" - bold, title case
\newcommand{\ingredientsheading}{\noindent\textbf{Ingredients}}
\newcommand{\instructionsheading}{\noindent\textbf{Instructions}}

% Subsection - recipe section headers like "Make the sauce" - bold italic
\titleformat{\subsection}
    {\normalfont\bfseries\itshape}
    {}
    {0pt}
    {}
    [\vspace{0.25em}]

% Lists
\usepackage{enumitem}
\usepackage{xcolor}

% Define colors
\definecolor{accentcolor}{HTML}{c1121f}
\definecolor{lighttext}{HTML}{6b6560}

% Ingredients list - centered dot bullets
\newlist{ingredients}{itemize}{1}
\setlist[ingredients]{
    label={\textperiodcentered},
    leftmargin=1.5em,
    labelsep=0.5em,
    itemsep=0.15\baselineskip,
    parsep=0pt,
    topsep=0.75em
}

% Instructions list - simple numbered list
\setlist[enumerate]{
    label={\arabic*.},
    leftmargin=2em,
    labelsep=0.75em,
    itemsep=0.5\baselineskip,
    parsep=0pt,
    topsep=0.5\baselineskip
}

% Headers and footers - all caps running headers
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
% Running headers: all caps, letterspaced, 8.5pt, ragged
\fancyhead[LE]{\fontsize{8.5}{10}\selectfont\raggedright\textls[100]{\MakeUppercase{\nouppercase{\leftmark}}}}
\fancyhead[RO]{\fontsize{8.5}{10}\selectfont\raggedleft\textls[100]{\MakeUppercase{\nouppercase{\rightmark}}}}
\fancyfoot[C]{\small\thepage}
\renewcommand{\headrulewidth}{0pt}

% Spacing between headers/footers and content
\setlength{\headheight}{14pt}
\setlength{\headsep}{24pt}
\setlength{\footskip}{18pt}

% Chapter page style (no header)
\fancypagestyle{plain}{
    \fancyhf{}
    \fancyfoot[C]{\small\thepage}
    \renewcommand{\headrulewidth}{0pt}
}

% Hyperlinks (for digital PDF)
\usepackage[
    colorlinks=true,
    linkcolor=black,
    urlcolor=black,
    citecolor=black,
    bookmarks=true,
    bookmarksnumbered=false,
    pdfborder={0 0 0}
]{hyperref}

% Better tables
\usepackage{booktabs}

% Graphics
\usepackage{graphicx}

% Better quotes
\usepackage{csquotes}

% Widow and orphan control
\widowpenalty=10000
\clubpenalty=10000

% Table of contents - all caps chapter names with dot leaders
\usepackage{tocloft}
\renewcommand{\cftdotsep}{2}
\renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}}
\setlength{\cftbeforesecskip}{0.5\baselineskip}
\renewcommand{\cftchapfont}{\normalfont}
\renewcommand{\cftchappagefont}{\normalfont}
\renewcommand{\cftsecfont}{\normalfont}
\renewcommand{\cftsecpagefont}{\normalfont}
\setlength{\cftbeforechapskip}{0.5em}

% Recipe metadata - italic, with interpunct separators
\newcommand{\recipemeta}[1]{%
    {\small\itshape\color{lighttext}#1\par}%
    \vspace{0.5em}%
    \noindent\rule{\textwidth}{0.25pt}%
    \vspace{1em}%
    \par
}

% Recipe description (headnote) - smaller, normal weight
\newcommand{\recipedescription}[1]{%
    {\normalsize #1\par}%
    \vspace{0.75\baselineskip}%
}

% Recipe attribution - italic, light color
\newcommand{\recipeattribution}[1]{%
    \vspace{1.5em}%
    {\small\itshape\color{lighttext}#1\par}%
}

% Spacing adjustments
\setlength{\parindent}{0pt}
\setlength{\parskip}{0.5em}

% Use ragged right (left-aligned) throughout to avoid awkward word spacing
\raggedright

% Start of document content
\begin{document}

% Front matter
\frontmatter

% Half-title page
\begin{titlepage}
{\centering
\vspace*{3in}
{\Huge\textls[150]{{COOKBOOK_TITLE}}}
\par}
\end{titlepage}

\cleardoublepage

% Title page
\begin{titlepage}
{\centering
\vspace*{2in}
{\Huge\textls[150]{{COOKBOOK_TITLE}}}\\[1.5em]
{\Large A Personal Cookbook}\\[3em]
{{COOKBOOK_AUTHOR_LINE}}\\
{\large Generated \today}
\par}
\end{titlepage}

\cleardoublepage

% Epigraph
\thispagestyle{empty}
{\centering
\vspace*{3in}
{\large\itshape``It's a cookbook!''}
\par}

\cleardoublepage

% Table of contents
\tableofcontents

\cleardoublepage

% Main matter
\mainmatter

